---
title: Preset Files (.milk)
description: An overview of the format of Milkdrop presets.
---

## General File Syntax

Since Milkdrop has been around since the late 1990's, the choice for the file format was based on best practices in
Windows development during that era. XML, JSON and other modern structural formats weren't a thing then, so the NullSoft
developers decided to use readily-available functions in the Win32 API to save and load presets and thus chose the
Windows INI file format.

A preset file consists of only a single INI section, `[preset00]`, which contains all parameters, expressions and shader
code blocks. Presets since Milkdrop 2 also use a few additional keys in the global section to enable use of HLSL pixel
shaders.

Each setting in the preset file follows the `key=value` scheme. If a key is present multiple times, the _first_ value
found in the file is being used.

## Default Parameters

Many default preset parameters follow a certain syntax, determining the data type expected as the value:

- Keys starting with `b` are considered boolean values, e.g. `0` means false/off and any non-zero value is considered
  true/on.
- Keys starting with `i` are parsed as integer values without decimals.
- Keys starting with `f` are floating-point numbers.

The values of default parameters can be changed within expressions in most, but not all cases. For example, the `enabled`
values of custom waves and shapes cannot be set in expressions, as well as the `shapecode_#_num_inst` value.

## Code Blocks

Milkdrop presets can contain expression code and HLSL shaders with more than a single line. Each code block has its own
key prefix (e.g. `per_frame_`), followed by a 1-based line number without leading zeroes. A code block is read in by
incrementing the line number by one each and then checking if the key exists. Once a key isn't found, the code block is
considered finished. A maximum of 99999 lines per code block are allowed.

Shader code blocks (with the `warp_` and `comp_` prefixes) start with an additional `` ` `` after the `=`, which is
discarded automatically when reading in the preset. Using the backtick is fully optional, e.g. shader code will parse
properly without it and expression code will be parsed correctly if there is a backtick at the beginning of each line's
value.
